<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapperPUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN""http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd"><!-- 不使用namespace的话sql搜索定位会比较方便 --><mapper namespace="com.lvmama.tnt.user.mapper.TntUserDetailMapper">	<cache eviction="LRU" size="5000" />	<resultMap id="baseResultMap" type="tntUserDetail">		<result property="userDetailId" column="USER_DETAIL_ID" />		<result property="userId" column="USER_ID" />		<result property="gender" column="GENDER" />		<result property="duties" column="DUTIES" />		<result property="department" column="DEPARTMENT" />		<result property="mobileNumber" column="MOBILE_NUMBER" />		<result property="phoneNumber" column="PHONE_NUMBER" />		<result property="faxNumber" column="FAX_NUMBER" />		<result property="address" column="ADDRESS" />		<result property="email" column="EMAIL" />		<result property="qqAccount" column="QQ_ACCOUNT" />		<result property="imageUrl" column="IMAGE_URL" />		<result property="cityId" column="CITY_ID" />		<result property="companyName" column="COMPANY_NAME" />		<result property="companyTypeId" column="COMPANY_TYPE_ID" />		<result property="chargePhone" column="CHARGE_PHONE" />		<result property="serviceTel" column="SERVICE_TEL" />		<result property="legalRepresentative" column="LEGAL_REPRESENTATIVE" />		<result property="companyProfile" column="COMPANY_PROFILE" />		<result property="employeeNum" column="EMPLOYEE_NUM" />		<result property="isEmailChecked" column="IS_EMAIL_CHECKED" />		<result property="isMobileChecked" column="IS_MOBILE_CHECKED" />		<result property="createdDate" column="CREATED_DATE" />		<result property="updatedDate" column="UPDATED_DATE" />		<result property="finalStatus" column="FINAL_STATUS" />		<result property="materialStatus" column="MATERIAL_STATUS" />		<result property="infoStatus" column="INFO_STATUS" />		<result property="failReason" column="FAIL_REASON" />		<result property="contractStartDate" column="CONTRACT_START_DATE" />		<result property="contractEndDate" column="CONTRACT_END_DATE" />		<result property="payType" column="PAY_TYPE" />		<result property="memo" column="MEMO" />		<result property="zipCode" column="zip_Code" />		<result property="netUrl" column="net_Url" />		<result property="provinceId" column="province_Id" />		<result property="chargeName" column="CHARGE_NAME" />		<result property="channelCode" column="CHANNEL_CODE" />		<result property="distributorKey" column="DISTRIBUTOR_KEY" />		<result property="distributorCode" column="DISTRIBUTOR_CODE" />		<result property="smsRemark" column="SMS_REMARK" />		<result property="cooperationMode" column="COOPERATION_MODE" />		<result property="operatingSpecialistId" column="OPERATING_SPECIALIST_ID" />		<result property="userConfigArgs" column="USER_CONFIG_ARGS" />		<result property="categoryTag" column="CATEGORY_TAG" />		<result property="smsChannel" column="SMS_CHANNEL" />		<!-- 新增是否发送电子合同字段 -->		<result property="isSendContract" column="IS_SEND_CONTRACT"/>		<result property="settleType" column="SETTLE_TYPE" />	</resultMap>	<resultMap id="userVoResultMap" type="com.lvmama.tnt.user.vo.TntUserVo">		<result property="userId" column="USER_ID" />		<result property="userName" column="USER_NAME" />		<result property="subName" column="SUB_NAME"/>		<result property="realName" column="REAL_NAME" />		<result property="companyName" column="COMPANY_NAME" />		<result property="companyTypeId" column="COMPANY_TYPE_ID" />		<result property="companyTypeName" column="COMPANY_TYPE_NAME" />		<result property="companyTypeCode" column="COMPANY_TYPE_CODE" />		<result property="channelId" column="CHANNEL_ID" />		<result property="channelName" column="CHANNEL_NAME" />		<result property="realName" column="REAL_NAME" />		<result property="channelCode" column="CHANNEL_CODE" />		<result property="distributorCode" column="DISTRIBUTOR_CODE" />		<result property="mobileNumber" column="MOBILE_NUMBER" />		<result property="operatingSpecialistId" column="OPERATING_SPECIALIST_ID" />		<result property="isSpecial" column="IS_SPECIAL" />		<result property="tntProductUserId" column="TNT_PRODUCT_USER_ID" />		<result property="userConfigArgs" column="USER_CONFIG_ARGS" />		<result property="valid" column="valid" />		<result property="finalStatus" column="FINAL_STATUS" />	</resultMap> 		<resultMap id="userDetailVoResultMap" type="com.lvmama.tnt.user.po.TntUserDetail">		<result property="userId" column="USER_ID" />		<result property="userName" column="USER_NAME" />		<result property="realName" column="REAL_NAME" />		<result property="companyName" column="COMPANY_NAME" />		<result property="companyTypeId" column="COMPANY_TYPE_ID" />		<result property="companyTypeName" column="COMPANY_TYPE_NAME" />		<result property="companyTypeCode" column="COMPANY_TYPE_CODE" />		<result property="channelId" column="CHANNEL_ID" />		<result property="channelName" column="CHANNEL_NAME" />		<result property="realName" column="REAL_NAME" />		<result property="channelCode" column="CHANNEL_CODE" />		<result property="distributorCode" column="DISTRIBUTOR_CODE" />		<result property="mobileNumber" column="MOBILE_NUMBER" />		<result property="operatingSpecialistId" column="OPERATING_SPECIALIST_ID" />		<result property="isSpecial" column="IS_SPECIAL" />		<result property="tntProductUserId" column="TNT_PRODUCT_USER_ID" />		<result property="userConfigArgs" column="USER_CONFIG_ARGS" />		<result property="valid" column="valid" />	</resultMap> 		<resultMap id="apiResultMap" type="com.lvmama.tnt.user.po.TntUserDetail">		<result property="userId" column="USER_ID" />		<result property="channelCode" column="CHANNEL_CODE" />		<result property="distributorKey" column="DISTRIBUTOR_KEY" />		<result property="distributorCode" column="DISTRIBUTOR_CODE" />		<result property="userConfigArgs" column="USER_CONFIG_ARGS" />		<result property="categoryTag" column="CATEGORY_TAG" />		<result property="packageCategoryTag" column="PACKAGE_CATEGORY_TAG" />	</resultMap>	<resultMap id="typeTotalMap" type="tntUserDetail">		<result property="companyTypeId" column="COMPANY_TYPE_ID" />		<result property="total" column="TOTAL" />	</resultMap>	<!-- 用于select查询公用抽取的列 -->	<sql id="columns">	    <![CDATA[		USER_DETAIL_ID,USER_ID,GENDER,DUTIES,DEPARTMENT,MOBILE_NUMBER,PHONE_NUMBER,FAX_NUMBER,ADDRESS,EMAIL,CHARGE_NAME,		QQ_ACCOUNT,IMAGE_URL,CITY_ID,COMPANY_NAME,COMPANY_TYPE_ID,CHARGE_PHONE,SERVICE_TEL,LEGAL_REPRESENTATIVE,		COMPANY_PROFILE,EMPLOYEE_NUM,IS_EMAIL_CHECKED,IS_MOBILE_CHECKED,CREATED_DATE,UPDATED_DATE,FINAL_STATUS,		MATERIAL_STATUS,INFO_STATUS,FAIL_REASON,CONTRACT_START_DATE,CONTRACT_END_DATE,MEMO,PAY_TYPE,zip_Code,net_Url,province_Id,CHANNEL_CODE,        DISTRIBUTOR_KEY,DISTRIBUTOR_CODE,SMS_REMARK,USER_CONFIG_ARGS,CATEGORY_TAG,IS_SEND_CONTRACT,SETTLE_TYPE,SMS_CHANNEL	    ]]>	</sql>	<insert id="insert" parameterType="tntUserDetail">		<selectKey resultType="java.lang.Long" keyProperty="userDetailId" order="BEFORE">			select			TNT_USER_DETAIL_ID_SEQ.nextval from dual		</selectKey>    <![CDATA[        INSERT INTO TNT_USER_DETAIL (        	USER_DETAIL_ID ,        	USER_ID ,        	GENDER ,        	DUTIES ,        	DEPARTMENT ,        	MOBILE_NUMBER ,        	PHONE_NUMBER ,        	FAX_NUMBER ,        	ADDRESS ,        	EMAIL ,        	QQ_ACCOUNT ,        	IMAGE_URL ,        	CITY_ID ,        	COMPANY_NAME ,        	COMPANY_TYPE_ID ,        	CHARGE_PHONE ,        	charge_Name ,        	SERVICE_TEL ,        	LEGAL_REPRESENTATIVE ,        	COMPANY_PROFILE ,        	EMPLOYEE_NUM ,        	IS_EMAIL_CHECKED ,        	IS_MOBILE_CHECKED ,        	CREATED_DATE ,        	UPDATED_DATE ,        	FINAL_STATUS ,        	MATERIAL_STATUS ,        	INFO_STATUS ,        	FAIL_REASON ,        	zip_Code,        	net_Url,        	PAY_TYPE,        	province_Id,        	CHANNEL_CODE,        	DISTRIBUTOR_KEY,        	DISTRIBUTOR_CODE,        	SMS_REMARK,        	MEMO,        	USER_CONFIG_ARGS,        	SMS_CHANNEL,        	CATEGORY_TAG,        	IS_SEND_CONTRACT        ) VALUES (        	#{userDetailId} ,        	#{userId,jdbcType=BIGINT} ,        	#{gender,jdbcType=VARCHAR} ,        	#{duties,jdbcType=VARCHAR} ,        	#{department,jdbcType=VARCHAR} ,        	#{mobileNumber,jdbcType=VARCHAR} ,        	#{phoneNumber,jdbcType=VARCHAR} ,        	#{faxNumber,jdbcType=VARCHAR} ,        	#{address,jdbcType=VARCHAR} ,        	#{email,jdbcType=VARCHAR} ,        	#{qqAccount,jdbcType=VARCHAR} ,        	#{imageUrl,jdbcType=VARCHAR} ,        	#{cityId,jdbcType=BIGINT} ,        	#{companyName,jdbcType=VARCHAR} ,        	#{companyTypeId,jdbcType=BIGINT} ,        	#{chargePhone,jdbcType=VARCHAR} ,        	#{chargeName,jdbcType=VARCHAR} ,        	#{serviceTel,jdbcType=VARCHAR} ,        	#{legalRepresentative,jdbcType=VARCHAR} ,        	#{companyProfile,jdbcType=VARCHAR} ,        	#{employeeNum,jdbcType=VARCHAR} ,        	#{isEmailChecked,jdbcType=VARCHAR} ,        	#{isMobileChecked,jdbcType=VARCHAR} ,        	sysdate ,        	sysdate ,        	#{finalStatus,jdbcType=VARCHAR} ,        	#{materialStatus,jdbcType=VARCHAR} ,        	#{infoStatus,jdbcType=VARCHAR} ,        	#{failReason,jdbcType=VARCHAR} ,        	#{zipCode,jdbcType=VARCHAR} ,        	#{netUrl,jdbcType=VARCHAR} ,        	#{payType,jdbcType=VARCHAR} ,        	#{provinceId,jdbcType=VARCHAR} ,        	#{channelCode,jdbcType=VARCHAR} ,        	#{distributorKey,jdbcType=VARCHAR} ,        	#{distributorCode,jdbcType=VARCHAR} ,        	#{smsRemark,jdbcType=VARCHAR} ,        	#{memo,jdbcType=VARCHAR},        	#{userConfigArgs,jdbcType=VARCHAR},        	#{smsChannel,jdbcType=VARCHAR},        	#{categoryTag,jdbcType=VARCHAR},        	#{isSendContract,jdbcType=VARCHAR}          )    ]]>	</insert>	<update id="update" parameterType="tntUserDetail">		UPDATE TNT_USER_DETAIL		<set>			UPDATED_DATE = sysdate,			<if test="gender != null">				GENDER = #{gender,jdbcType=VARCHAR} ,			</if>			<if test="duties != null">				DUTIES = #{duties,jdbcType=VARCHAR} ,			</if>			<if test="department != null">				DEPARTMENT = #{department,jdbcType=VARCHAR} ,			</if>			<if test="mobileNumber != null">				MOBILE_NUMBER = #{mobileNumber,jdbcType=VARCHAR} ,			</if>			<if test="phoneNumber != null">				PHONE_NUMBER = #{phoneNumber,jdbcType=VARCHAR} ,			</if>			<if test="faxNumber != null">				FAX_NUMBER = #{faxNumber,jdbcType=VARCHAR} ,			</if>			<if test="address != null">				ADDRESS = #{address,jdbcType=VARCHAR} ,			</if>			<if test="email != null">				EMAIL = #{email,jdbcType=VARCHAR} ,			</if>			<if test="qqAccount != null">				QQ_ACCOUNT = #{qqAccount,jdbcType=VARCHAR} ,			</if>			<if test="imageUrl != null">				IMAGE_URL = #{imageUrl,jdbcType=VARCHAR} ,			</if>			<if test="cityId != null">				CITY_ID = #{cityId} ,			</if>			<if test="companyName != null">				COMPANY_NAME = #{companyName,jdbcType=VARCHAR} ,			</if>			<if test="companyTypeId != null">				COMPANY_TYPE_ID = #{companyTypeId} ,			</if>			<if test="chargePhone != null">				CHARGE_PHONE = #{chargePhone,jdbcType=VARCHAR} ,			</if>			<if test="chargeName != null">				charge_Name = #{chargeName,jdbcType=VARCHAR} ,			</if>			<if test="serviceTel != null">				SERVICE_TEL = #{serviceTel,jdbcType=VARCHAR} ,			</if>			<if test="legalRepresentative != null">				LEGAL_REPRESENTATIVE =				#{legalRepresentative,jdbcType=VARCHAR} ,			</if>			<if test="companyProfile != null">				COMPANY_PROFILE = #{companyProfile,jdbcType=VARCHAR} ,			</if>			<if test="employeeNum != null">				EMPLOYEE_NUM = #{employeeNum,jdbcType=VARCHAR} ,			</if>			<if test="isEmailChecked != null">				IS_EMAIL_CHECKED = #{isEmailChecked,jdbcType=VARCHAR} ,			</if>			<if test="isMobileChecked != null">				IS_MOBILE_CHECKED = #{isMobileChecked,jdbcType=VARCHAR} ,			</if>			<if test="finalStatus != null">				FINAL_STATUS = #{finalStatus,jdbcType=VARCHAR} ,			</if>			<if test="materialStatus != null">				MATERIAL_STATUS = #{materialStatus,jdbcType=VARCHAR} ,			</if>			<if test="infoStatus != null">				INFO_STATUS = #{infoStatus,jdbcType=VARCHAR} ,			</if>			<if test="failReason != null">				FAIL_REASON = #{failReason,jdbcType=VARCHAR} ,			</if>			<if test="contractStartDate != null">				CONTRACT_START_DATE = #{contractStartDate} ,			</if>			<if test="contractEndDate != null">				CONTRACT_END_DATE = #{contractEndDate} ,			</if>			<if test="zipCode != null">				zip_Code = #{zipCode,jdbcType=VARCHAR} ,			</if>			<if test="netUrl != null">				net_Url = #{netUrl,jdbcType=VARCHAR} ,			</if>			<if test="provinceId != null">				province_Id = #{provinceId} ,			</if>			<if test="memo != null">				MEMO = #{memo,jdbcType=VARCHAR},			</if>			<if test="payType != null">				PAY_TYPE = #{payType,jdbcType=VARCHAR},			</if>			<if test="channelCode != null">				CHANNEL_CODE = #{channelCode,jdbcType=VARCHAR},			</if>			<if test="distributorCode != null">				DISTRIBUTOR_CODE = #{distributorCode,jdbcType=VARCHAR},			</if>			<if test="distributorKey != null">				DISTRIBUTOR_KEY = #{distributorKey,jdbcType=VARCHAR},			</if>					<if test="smsRemark != null">				SMS_REMARK = #{smsRemark,jdbcType=VARCHAR},			</if>			<if test="cooperationMode != null">				COOPERATION_MODE = #{cooperationMode,jdbcType=VARCHAR},			</if>			<if test="operatingSpecialistId != null">				Operating_Specialist_id = #{operatingSpecialistId},			</if>			<if test="categoryTag != null">				CATEGORY_TAG = #{categoryTag,jdbcType=VARCHAR},			</if>			<if test="userConfigArgs != null">                USER_CONFIG_ARGS = #{userConfigArgs,jdbcType=VARCHAR},            </if>            <if test="smsChannel != null">                SMS_CHANNEL = #{smsChannel,jdbcType=VARCHAR},            </if>            <if test="isSendContract !=null">            	IS_SEND_CONTRACT = #{isSendContract,jdbcType=VARCHAR},            </if>    		<if test="settleType != null">                SETTLE_TYPE = #{settleType,jdbcType=VARCHAR}            </if>		</set>		<trim prefix="WHERE" prefixOverrides="AND |OR ">			<if test="userDetailId != null">USER_DETAIL_ID = #{userDetailId} </if>			<if test="userId != null">				and USER_ID = #{userId}			</if>		</trim>	</update>	<delete id="delete">    <![CDATA[        DELETE FROM TNT_USER_DETAIL WHERE        USER_DETAIL_ID = #{id}     ]]>	</delete>	<select id="getById" resultMap="baseResultMap" useCache="false">		SELECT		<include refid="columns" />	    <![CDATA[		    FROM TNT_USER_DETAIL 	        WHERE 		        USER_DETAIL_ID = #{id} 	    ]]>	</select>	<select id="getByUserId" resultMap="baseResultMap" parameterType="java.lang.String" useCache="false">		SELECT		<include refid="columns" />	    <![CDATA[		    FROM TNT_USER_DETAIL 	        WHERE 		        USER_ID = #{userId} 	    ]]>	</select>	<select id="selectOneByUserId" resultMap="baseResultMap" useCache="false">		SELECT		<include refid="columns" />	    <![CDATA[		    FROM TNT_USER_DETAIL 	        WHERE 		        USER_ID = #{id} 	    ]]>	</select>	<sql id="whereSQL">		<if test="userDetailId!=null and userDetailId!=''">			AND USER_DETAIL_ID = #{userDetailId}		</if>		<if test="userId!=null and userId!=''">			AND USER_ID = #{userId}		</if>		<if test="gender!=null and gender!=''">			AND GENDER = #{gender}		</if>		<if test="duties!=null and duties!=''">			AND DUTIES = #{duties}		</if>		<if test="department!=null and department!=''">			AND DEPARTMENT = #{department}		</if>		<if test="mobileNumber!=null and mobileNumber!=''">			AND MOBILE_NUMBER = #{mobileNumber}		</if>		<if test="phoneNumber!=null and phoneNumber!=''">			AND PHONE_NUMBER = #{phoneNumber}		</if>		<if test="faxNumber!=null and faxNumber!=''">			AND FAX_NUMBER = #{faxNumber}		</if>		<if test="address!=null and address!=''">			AND ADDRESS = #{address}		</if>		<if test="email!=null and email!=''">			AND EMAIL = #{email}		</if>		<if test="qqAccount!=null and qqAccount!=''">			AND QQ_ACCOUNT = #{qqAccount}		</if>		<if test="imageUrl!=null and imageUrl!=''">			AND IMAGE_URL = #{imageUrl}		</if>		<if test="cityId!=null and cityId!=''">			AND CITY_ID = #{cityId}		</if>		<if test="companyName!=null and companyName!=''">			AND COMPANY_NAME = #{companyName}		</if>		<if test="companyTypeId!=null and companyTypeId!=''">			AND COMPANY_TYPE_ID = #{companyTypeId}		</if>		<if test="chargePhone!=null and chargePhone!=''">			AND CHARGE_PHONE = #{chargePhone}		</if>		<if test="serviceTel!=null and serviceTel!=''">			AND SERVICE_TEL = #{serviceTel}		</if>		<if test="legalRepresentative!=null and legalRepresentative!=''">			AND LEGAL_REPRESENTATIVE = #{legalRepresentative}		</if>		<if test="companyProfile!=null and companyProfile!=''">			AND COMPANY_PROFILE = #{companyProfile}		</if>		<if test="employeeNum!=null and employeeNum!=''">			AND EMPLOYEE_NUM = #{employeeNum}		</if>		<if test="isEmailChecked!=null and isEmailChecked!=''">			AND IS_EMAIL_CHECKED = #{isEmailChecked}		</if>		<if test="isMobileChecked!=null and isMobileChecked!=''">			AND IS_MOBILE_CHECKED = #{isMobileChecked}		</if>		<!-- <if test="createdDateBegin!=null and createdDateBegin!=''"> AND CREATED_DATE >= #{createdDateBegin} </if> <if test="createdDateEnd!=null 			and createdDateEnd!=''"> AND CREATED_DATE &lt;= #{createdDateEnd} </if> <if test="updatedDateBegin!=null and updatedDateBegin!=''"> 			AND UPDATED_DATE >= #{updatedDateBegin} </if> <if test="updatedDateBegin!=null and updatedDateBegin!=''"> AND UPDATED_DATE 			&lt;= #{updatedDateEnd} </if> -->		<if test="finalStatus!=null and finalStatus!=''">			AND FINAL_STATUS = #{finalStatus}		</if>		<if test="materialStatus!=null and materialStatus!=''">			AND MATERIAL_STATUS = #{materialStatus}		</if>		<if test="infoStatus!=null and infoStatus!=''">			AND INFO_STATUS = #{infoStatus}		</if>		<if test="payType!=null and payType!=''">			AND PAY_TYPE = #{payType}		</if>		<if test="distributorCode!=null and distributorCode!=''">			AND DISTRIBUTOR_CODE = #{distributorCode}		</if>		<if test="isSendContract!=null and isSendContract!=''">			AND IS_SEND_CONTRACT = #{isSendContract}		</if>	</sql>	<select id="findCount" resultType="long" useCache="false">		SELECT count(*) FROM TNT_USER_DETAIL		<where>			<include refid="whereSQL" />		</where>	</select>	<select id="selectCompanyTypeTotalList" resultMap="typeTotalMap" useCache="false">		SELECT COMPANY_TYPE_ID,count(1) as TOTAL FROM TNT_USER_DETAIL		<where>			<include refid="whereSQL" />		</where>		GROUP BY COMPANY_TYPE_ID	</select>	<select id="containTypeUsers" resultType="Long" parameterType="tntUserDetail" useCache="false">		SELECT USER_DETAIL_ID FROM TNT_USER_DETAIL		<where>			<include refid="whereSQL" />		</where>	</select>	<select id="fuzzyQueryByCompanyName" resultMap="userVoResultMap" parameterType="String" useCache="false">		SELECT *		FROM (SELECT T.*, ROWNUM		AS ROWNUM1		FROM (SELECT TUD.USER_ID,		TUD.DISTRIBUTOR_CODE,		TUD.COMPANY_NAME,		U.USER_NAME,		TC.CHANNEL_ID,		TC.CHANNEL_NAME,		TCT.COMPANY_TYPE_ID,		TCT.COMPANY_TYPE_NAME		FROM TNT_USER_DETAIL TUD, TNT_CHANNEL TC, TNT_COMPANY_TYPE TCT, TNT_USER U		WHERE		TUD.USER_ID=U.USER_ID AND		TC.CHANNEL_ID = TCT.CHANNEL_ID		AND TUD.COMPANY_TYPE_ID = TCT.COMPANY_TYPE_ID		AND TUD.COMPANY_NAME like		CONCAT(CONCAT('%',#{companyName}),'%')) T		WHERE ROWNUM &lt;= 10) WHERE ROWNUM1 &gt;0	</select>	<select id="selectWithChannelAndCompanyType" resultMap="userVoResultMap" parameterType="tntUserDetail" useCache="true">		select		a.USER_ID,a.COMPANY_TYPE_ID,a.COMPANY_NAME,b.COMPANY_TYPE_NAME,b.COMPANY_TYPE_CODE,b.CHANNEL_ID,c.CHANNEL_NAME,c.CHANNEL_CODE,d.USER_NAME,d.REAL_NAME,a.MOBILE_NUMBER,a.FINAL_STATUS		from		TNT_USER_DETAIL		a,TNT_COMPANY_TYPE		b,TNT_CHANNEL c,		TNT_USER d		where		a.COMPANY_TYPE_ID = b.COMPANY_TYPE_ID		and		b.CHANNEL_ID = c.CHANNEL_ID		and a.USER_ID = d.USER_ID		<if test="userId!=null and userId!=''">			AND a.USER_ID = #{userId}		</if>		<if test="channelCode!=null and channelCode!=''">			AND a.CHANNEL_CODE = #{channelCode}		</if>		<if test="finalStatus!=null and finalStatus!=''">            AND a.FINAL_STATUS = #{finalStatus}        </if>	</select>	<select id="selectUserDetailAndUser" resultMap="userDetailVoResultMap" parameterType="page" useCache="false"> 		<include refid="basic.pageSearchHead" />		SELECT distinct u.user_id,d.company_name,c.channel_name,u.real_name,d.channel_code,distributor_Code,OPERATING_SPECIALIST_ID,P.IS_SPECIAL,d.USER_CONFIG_ARGS,p.valid 		FROM Tnt_User_Detail d ,TNT_user u,tnt_channel c,TNT_PRODUCT_USER P where		d.user_id=u.user_id and d.channel_code=c.channel_code AND u.user_id = P.user_id(+)		AND P.GOODS_ID(+) = #{param.goodsId}   		<if test="param.channelCode != null and param.channelCode !=''">			AND d.channel_code = #{param.channelCode}		</if>		<if test="param.channelCode == 'DISTRIBUTOR_B2B'">			AND D.FINAL_STATUS='DOING'		</if>		<if test="param.realName != null and param.realName !=''">			AND u.REAL_NAME like CONCAT(CONCAT('%',#{param.realName}),'%')		</if>		<if test="param.companyName != null and param.companyName !=''">			AND d.COMPANY_NAME like CONCAT(CONCAT('%',#{param.companyName}),'%')		</if>		<if test="param.operatingSpecialistId != null and param.operatingSpecialistId !=''">			AND d.OPERATING_SPECIALIST_ID = #{param.operatingSpecialistId}		</if>		<!-- <if test="param.isSpecial != null and param.isSpecial eq 'Y'.toString()">			AND EXISTS (SELECT 1 FROM TNT_PRODUCT_USER TPU WHERE TPU.USER_ID=u.user_id AND TPU.GOODS_ID=#{param.goodsId} AND TPU.IS_SPECIAL=#{param.isSpecial})		</if>		 <if test="param.isSpecial != null and param.isSpecial eq 'N'.toString()">			AND EXISTS (SELECT 1 FROM TNT_PRODUCT_USER TPU WHERE TPU.USER_ID=u.user_id AND TPU.GOODS_ID=#{param.goodsId} AND TPU.IS_SPECIAL=#{param.isSpecial})		</if> -->		<if test="param.isSpecial != null and param.isSpecial !=''">			AND P.IS_SPECIAL =#{param.isSpecial}		</if>		<!-- 只查询一级分销商  added by lgx-->		AND u.level_id = '0'		ORDER BY D.CHANNEL_CODE ASC, U.USER_ID DESC		<include refid="basic.pageSearchFoot" />	</select>	<select id="countWithUserDetailAndUser" resultType="Long" parameterType="com.lvmama.tnt.user.po.TntUserDetail" useCache="false">		SELECT count(distinct u.user_id) FROM Tnt_User_Detail d ,TNT_user u,tnt_channel c,TNT_PRODUCT_USER P		where d.user_id=u.user_id and		d.channel_code=c.channel_code		AND u.user_id = P.user_id(+)		AND P.GOODS_ID(+) = #{goodsId}   		<if test="channelCode != null and channelCode !=''">			AND d.channel_code = #{channelCode}		</if>		<if test="channelCode == 'DISTRIBUTOR_B2B'">			AND D.FINAL_STATUS='DOING'		</if>		<if test="realName != null and realName !=''">			AND u.REAL_NAME like CONCAT(CONCAT('%',#{realName}),'%')		</if>		<if test="companyName != null and companyName !=''">			AND d.COMPANY_NAME like CONCAT(CONCAT('%',#{companyName}),'%')		</if>		<if test="operatingSpecialistId != null and operatingSpecialistId !=''">			AND d.OPERATING_SPECIALIST_ID = #{operatingSpecialistId}		</if>		<!-- <if test="isSpecial != null  and isSpecial eq 'Y'.toString()">			AND EXISTS (SELECT 1 FROM TNT_PRODUCT_USER TPU WHERE TPU.USER_ID=u.user_id AND TPU.GOODS_ID=#{goodsId} AND TPU.IS_SPECIAL=#{isSpecial})		</if>		<if test="isSpecial != null and isSpecial eq 'N'.toString()">			AND EXISTS (SELECT 1 FROM TNT_PRODUCT_USER TPU WHERE TPU.USER_ID=u.user_id AND TPU.GOODS_ID=#{goodsId} AND TPU.IS_SPECIAL=#{isSpecial})		</if> -->		<if test="isSpecial != null and isSpecial !=''">			AND P.IS_SPECIAL =#{isSpecial}		</if>		<!-- 只查询一级分销商  added by lgx-->		AND u.level_id = '0'	</select>	<select id="selectUserIdbyChannelId" resultMap="baseResultMap" parameterType="java.lang.Long" useCache="false">		select *		from tnt_user_detail tud,		tnt_company_type tct		where tud.company_type_id = tct.company_type_id		and tct.channel_id = #{channelId}	</select>		<select id="queryNewApiDetailByProdId" resultMap="apiResultMap" parameterType="java.lang.Long" useCache="false">		SELECT DISTINCT TUD.USER_ID,                TUD.DISTRIBUTOR_CODE,                TUD.DISTRIBUTOR_KEY,                TUD.CHANNEL_CODE,                TUD.USER_CONFIG_ARGS		FROM LVMAMA_PET.TNT_USER_DETAIL        TUD,		     LVMAMA_PET.USER_DISTRIBUTOR_RATE  UDR,		     LVMAMA_PET.TNT_PRODUCT            TP		WHERE  UDR.USER_ID = TUD.USER_ID		   AND UDR.SUB_PRODUCT_TYPE_ID = TP.CATEGORY_ID		   AND TP.PRODUCT_ID = #{productId}		   AND TUD.CHANNEL_CODE = 'DISTRIBUTOR_API'		   AND TP.CHANNEL_IDS LIKE '%101%'		   AND TUD.USER_CONFIG_ARGS LIKE '%IS_API2%'				   AND NOT EXISTS (SELECT 1		          FROM LVMAMA_PET.TNT_PRODUCT_USER PUSER		         WHERE PUSER.USER_ID = TUD.USER_ID		           AND TP.BRANCH_ID = PUSER.GOODS_ID		           AND PUSER.VALID = 'false'		           AND PUSER.PRODUCT_ID = #{productId}		           AND PUSER.TYPE = UDR.SUB_PRODUCT_TYPE_ID)	</select>		<select id="getApiDetailByProdId" resultMap="apiResultMap" parameterType="java.lang.Long" useCache="false">		  SELECT DISTINCT TUD.USER_ID,                TUD.DISTRIBUTOR_CODE,                TUD.DISTRIBUTOR_KEY,                TUD.CHANNEL_CODE,                TUD.USER_CONFIG_ARGS		  FROM LVMAMA_PET.TNT_USER_DETAIL       TUD,		       LVMAMA_PET.USER_DISTRIBUTOR_RATE UDR,		       LVMAMA_PET.TNT_PRODUCT           TP		 where UDR.USER_ID = TUD.USER_ID		   AND UDR.SUB_PRODUCT_TYPE_ID = TP.CATEGORY_ID		   AND tp.branch_id =  #{branchId}		   AND TUD.CHANNEL_CODE = 'DISTRIBUTOR_API' 			AND tp.CHANNEL_IDS LIKE '%101%'			AND TUD.USER_CONFIG_ARGS NOT LIKE '%IS_API2%'		   AND NOT EXISTS (SELECT 1		          FROM LVMAMA_PET.TNT_PRODUCT_USER PUSER		         WHERE PUSER.USER_ID = TUD.USER_ID		           AND PUSER.VALID = 'false' AND TP.BRANCH_ID=PUSER.GOODS_ID		           AND PUSER.goods_id =  #{branchId}		           AND PUSER.TYPE = UDR.SUB_PRODUCT_TYPE_ID)	</select>		<!--modify by changf 20160408 过滤不支持传真票的分销商   -->	<select id="getApiDetailByProdIdAndOnlinePay" resultMap="apiResultMap" parameterType="java.util.HashMap" useCache="false">		  SELECT DISTINCT TUD.USER_ID,                TUD.DISTRIBUTOR_CODE,                TUD.DISTRIBUTOR_KEY,                TUD.CHANNEL_CODE,                TUD.USER_CONFIG_ARGS		  FROM LVMAMA_PET.TNT_USER_DETAIL       TUD,		       LVMAMA_PET.USER_DISTRIBUTOR_RATE UDR,		       LVMAMA_PET.TNT_PRODUCT           TP		 where UDR.USER_ID = TUD.USER_ID		   AND UDR.SUB_PRODUCT_TYPE_ID = TP.CATEGORY_ID		   AND tp.branch_id =  #{branchId}		   AND UDR.pay_online = #{online}		   AND TUD.CHANNEL_CODE = 'DISTRIBUTOR_API' 			AND tp.CHANNEL_IDS LIKE '%101%'			AND TUD.USER_CONFIG_ARGS NOT LIKE '%IS_API2%'		   AND NOT EXISTS (SELECT 1		          FROM LVMAMA_PET.TNT_PRODUCT_USER PUSER		         WHERE PUSER.USER_ID = TUD.USER_ID		           AND PUSER.VALID = 'false' AND TP.BRANCH_ID=PUSER.GOODS_ID		           AND PUSER.goods_id =  #{branchId}		           AND PUSER.TYPE = UDR.SUB_PRODUCT_TYPE_ID)		           AND instr(TUD.USER_CONFIG_ARGS,		             (case		               when exists (select 1		                       from LVMAMA_PET.Tnt_Ticket_Product ttp		                      where ttp.branch_id = tp.branch_id		                        and ttp.branch_id = #{branchId}		                        and instr(ttp.is_fax_ticket, 'Y') > 0) then		                'FILTER_FAX_TICKET'		               else		                ' '		             end)) = 0	</select>		<!--modify by changf 20160408 过滤不支持传真票的分销商  -->	<select id="getNewApiDetailByProdIdAndOnlinePay" resultMap="apiResultMap" parameterType="java.util.HashMap" useCache="false">		  SELECT DISTINCT TUD.USER_ID,                TUD.DISTRIBUTOR_CODE,                TUD.DISTRIBUTOR_KEY,                TUD.CHANNEL_CODE,                TUD.USER_CONFIG_ARGS		  FROM LVMAMA_PET.TNT_USER_DETAIL       TUD,		       LVMAMA_PET.USER_DISTRIBUTOR_RATE UDR,		       LVMAMA_PET.TNT_PRODUCT           TP		 where UDR.USER_ID = TUD.USER_ID		   AND UDR.SUB_PRODUCT_TYPE_ID = TP.CATEGORY_ID		   AND tp.branch_id =  #{branchId}		   AND TUD.CHANNEL_CODE = 'DISTRIBUTOR_API'		   AND UDR.pay_online = #{online} 			AND tp.CHANNEL_IDS LIKE '%101%'			AND TUD.USER_CONFIG_ARGS LIKE '%IS_API2%'		   AND NOT EXISTS (SELECT 1		          FROM LVMAMA_PET.TNT_PRODUCT_USER PUSER		         WHERE PUSER.USER_ID = TUD.USER_ID		           AND PUSER.VALID = 'false' AND TP.BRANCH_ID=PUSER.GOODS_ID		           AND PUSER.goods_id =  #{branchId}		           AND PUSER.TYPE = UDR.SUB_PRODUCT_TYPE_ID)				   AND instr(TUD.USER_CONFIG_ARGS,		             (case		               when exists (select 1		                       from LVMAMA_PET.Tnt_Ticket_Product ttp		                      where ttp.branch_id = tp.branch_id		                        and ttp.branch_id = #{branchId}		                        and instr(ttp.is_fax_ticket, 'Y') > 0) then		                'FILTER_FAX_TICKET'		               else		                ' '		             end)) = 0	</select>		<!-- 根据套餐id，查询线路api2.0的分销商 -->	<select id="getNewApiDetailByProdId" resultMap="apiResultMap" parameterType="java.lang.Long" useCache="false">			select distinct tud.user_id,				tud.distributor_code,				tud.distributor_key,				tud.channel_code,				tud.user_config_args,				tud.category_tag ,				tsp.category_tag as package_category_tag			from lvmama_pet.tnt_user_detail tud,				lvmama_pet.user_distributor_rate udr,				lvmama_pet.tnt_product tp ,				lvmama_pet.tnt_sell_package tsp			where udr.user_id = tud.user_id			and udr.sub_product_type_id = tp.category_id			and tp.branch_id = #{branchId}			and tud.channel_code = 'DISTRIBUTOR_API'			and tp.channel_ids like '%101%'			and tud.user_config_args like '%IS_API2%'			and tp.branch_id = tsp.tnt_sell_package_id			and not exists			(				select 1				from lvmama_pet.tnt_product_user puser				where puser.user_id = tud.user_id				and puser.valid = 'false'				and tp.branch_id = puser.goods_id				and puser.goods_id = #{branchId}				and puser.type = udr.sub_product_type_id			) 	</select>		<!-- 根据套餐id，查询线路的分销商 -->	<select id="getRouteUserIdsByProdId" resultMap="apiResultMap" parameterType="java.lang.Long" useCache="false">		select distinct tud.user_id,				tud.distributor_code,				tud.distributor_key,				tud.channel_code,				tud.user_config_args,				tud.category_tag ,				tsp.category_tag as package_category_tag	      from lvmama_pet.tnt_user_detail tud,	        lvmama_pet.user_distributor_rate udr,	        lvmama_pet.tnt_product tp ,	        lvmama_pet.tnt_sell_package tsp	      where udr.user_id = tud.user_id	      and udr.sub_product_type_id = tp.category_id	      and tp.branch_id = #{objectId}	      and tud.channel_code = 'DISTRIBUTOR_API'	      and tud.user_config_args like '%IS_API2%'	      and tp.branch_id = tsp.tnt_sell_package_id	      and tp.product_type='PACKAGE'	</select>	<select id="getCountByDistributionGoodId" resultType="Integer" parameterType="java.util.HashMap" useCache="false">		SELECT		COUNT(TUD.USER_ID)		FROM LVMAMA_PET.TNT_USER_DETAIL TUD,		LVMAMA_PET.USER_DISTRIBUTOR_RATE UDR,		LVMAMA_PET.TNT_PRODUCT TP		where UDR.USER_ID = TUD.USER_ID		AND UDR.SUB_PRODUCT_TYPE_ID = TP.CATEGORY_ID		AND tp.branch_id = #{goodId}		AND		TUD.CHANNEL_CODE = 'DISTRIBUTOR_API'		AND tp.CHANNEL_IDS LIKE '%101%'		AND TUD.DISTRIBUTOR_CODE = #{distributorCode}		AND TUD.USER_CONFIG_ARGS LIKE '%IS_PRODUCT3%'		AND NOT EXISTS		(SELECT 1		FROM LVMAMA_PET.TNT_PRODUCT_USER PUSER		WHERE PUSER.USER_ID = TUD.USER_ID		AND PUSER.VALID = 'false' AND TP.BRANCH_ID=PUSER.GOODS_ID		AND PUSER.goods_id = #{goodId}		AND PUSER.TYPE = UDR.SUB_PRODUCT_TYPE_ID)	</select>    	<select id="listUserIdsByChannelCode" resultType="java.lang.Long" parameterType="java.lang.String" useCache="false">         select user_id from tnt_user_detail d where d.channel_code = #{channelCode}    </select>        <select id="listAllUserIdsByCoopMode" resultType="java.lang.Long" parameterType="java.lang.String" useCache="false">         select user_id from tnt_user_detail d where d.channel_code = #{channelCode} and d.COOPERATION_MODE = #{cooperationMode}    </select>		<select id="selectDetailbySecialistId" resultMap="baseResultMap" parameterType="java.lang.Long" useCache="false">		select *		from tnt_user_detail 		where OPERATING_SPECIALIST_ID = #{operatingSpecialistId}	</select>		<select id="selectCooperationMode" resultType="java.lang.String" parameterType="java.lang.Long">        select COOPERATION_MODE        from tnt_user_detail         where USER_ID = #{userId}     </select>    	 <select id="selectUserConfigByChannelId" resultType="com.lvmama.tnt.prod.service.distset.TntUserConfigVo" parameterType="Map" useCache="false">        SELECT b.user_id as userId,b.user_config_args as userConfigArgs from tnt_user_detail b,tnt_channel c        WHERE b.channel_code = c.channel_code               and c.channel_id = #{channelId}    </select>        <!-- wuzhanjie start 20151225 -->	<select id="getSingleChannelIdColumnByUserId" resultType="java.lang.Long" parameterType="java.lang.Long">		SELECT		TC.CHANNEL_ID		FROM		TNT_CHANNEL TC ,		TNT_USER_DETAIL TUD		WHERE		TC.CHANNEL_CODE = TUD.CHANNEL_CODE		AND TUD.USER_ID=#{userId}	</select>	<!-- wuzhanjie end 20151225 -->        <select id="fuzzyQueryByUserName" parameterType="String" useCache="false" resultMap="userVoResultMap">	     SELECT * FROM 	     ( SELECT T.*,ROWNUM AS ROWNUM1 FROM 	     ( SELECT TUD.USER_ID, U.USER_NAME, TC.CHANNEL_ID FROM TNT_USER U,TNT_USER_DETAIL TUD, 	     TNT_CHANNEL TC WHERE U.USER_ID = TUD.USER_ID AND TUD.CHANNEL_CODE = TC.CHANNEL_CODE 	     AND U.USER_NAME like CONCAT(CONCAT('%',#{userName}),'%'))T 	     WHERE ROWNUM &lt;= 10) WHERE ROWNUM1 &gt;0     </select>           <select id="fuzzyQueryByRealName" parameterType="String" useCache="false" resultMap="userVoResultMap">	      SELECT * FROM 	      ( SELECT T.*,ROWNUM AS ROWNUM1	       FROM ( SELECT U.REAL_NAME,TUD.USER_ID, TC.CHANNEL_ID FROM TNT_USER U,TNT_USER_DETAIL TUD, TNT_CHANNEL TC 	       WHERE U.USER_ID = TUD.USER_ID AND TUD.CHANNEL_CODE = TC.CHANNEL_CODE 	       AND U.REAL_NAME like CONCAT(CONCAT('%',#{realName}),'%'))T 	       WHERE ROWNUM &lt;= 10) WHERE ROWNUM1 &gt;0    </select>	<select id="queryBySubName" resultMap="userVoResultMap" parameterType="String" useCache="false">		SELECT *		FROM (SELECT T.*, ROWNUM AS ROWNUM1		FROM (SELECT TUD.USER_ID,		TUD.DISTRIBUTOR_CODE,		TUD.COMPANY_NAME,        U.USER_NAME,		TC.CHANNEL_ID,		TC.CHANNEL_NAME,		TCT.COMPANY_TYPE_ID,		TCT.COMPANY_TYPE_NAME,		TSU.SUB_NAME		FROM TNT_USER_DETAIL  TUD,		TNT_SUB_USER     TSU,		TNT_CHANNEL      TC,		TNT_COMPANY_TYPE TCT,		TNT_USER U		WHERE		TUD.USER_ID=U.USER_ID		AND TC.CHANNEL_ID = TCT.CHANNEL_ID		AND TUD.COMPANY_TYPE_ID = TCT.COMPANY_TYPE_ID		AND TSU.TNT_USER_ID = TUD.USER_ID		AND TSU.SUB_NAME = #{subName}) T		WHERE ROWNUM &lt;= 5)		WHERE ROWNUM1 &gt; 0	</select>	<select id="findUserByUserName" resultMap="userVoResultMap" parameterType="String" useCache="false">		SELECT *		FROM (SELECT T.*, ROWNUM AS ROWNUM1		FROM (SELECT TUD.USER_ID,		TUD.DISTRIBUTOR_CODE,		TUD.COMPANY_NAME,U.USER_NAME,		TC.CHANNEL_ID, TC.CHANNEL_NAME,		TCT.COMPANY_TYPE_ID, TCT.COMPANY_TYPE_NAME		FROM TNT_USER_DETAIL TUD,TNT_USER U,TNT_CHANNEL TC,		TNT_COMPANY_TYPE TCT WHERE U.USER_ID=TUD.USER_ID		AND TC.CHANNEL_ID = TCT.CHANNEL_ID		AND TUD.COMPANY_TYPE_ID = TCT.COMPANY_TYPE_ID		AND U.USER_NAME like CONCAT(CONCAT('%',#{userName}),'%')) T		WHERE ROWNUM &lt;= 10) WHERE ROWNUM1 &gt;0	</select></mapper>